{"version":3,"sources":["views/movie/detail.js"],"names":["Component","moment","locale","callback","key","console","log","site","DPlayer","window","TabPane","Tabs","Detail","props","_getMovieDetail","method","url","state","_id","then","data","movie","video","videoKey","pic","coverKey","setState","relativeMovies","player","container","document","getElementById","screenshot","thumbnails","loading","match","params","id","title","rate","backgroundColor","tags","join","meta","createdAt","fromNow","summary","map","item","posterKey","rawTitle","pubdate","it","i","date","format","country"],"mappings":"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","file":"detail.bbe92585.js","sourceRoot":"../src","sourcesContent":["import React,{ Component } from 'react';\nimport { Tabs,Badge } from 'antd';\nimport moment from 'moment';\nimport { request } from '../../lib'; \nimport { Link } from 'react-router-dom';\nimport 'moment/locale/zh-cn';\n\nmoment.locale('zh-cn');\n\nconst callback = (key) => {\n  console.log(key);\n}\n\nconst site = 'http://wdlj.zoomdong.xin/'\nconst DPlayer = window.DPlayer;\nconst TabPane = Tabs.TabPane;\nexport default class Detail extends Component{\n  constructor(props){\n    super(props)\n    this.state = {\n      loading: false,\n      relativeMovies: [],\n      _id: this.props.match.params.id,\n      movie: null\n    }\n  }\n\n  componentDidMount () {\n    this._getMovieDetail()\n  }\n\n  _getMovieDetail = () => {\n    request({\n      method: 'get',\n      url: `/api/v0/movies/${this.state._id}`\n    })\n    .then(data => {\n      const movie = data.movie\n      const video = site + movie.videoKey\n      const pic = site + movie.coverKey\n\n      this.setState({\n        movie: data.movie,\n        relativeMovies: data.relativeMovies,\n      }, () => {\n        this.player = new DPlayer({\n          container: document.getElementById('videoPlayer'),\n          screenshot: true,\n          video: {\n            url: video,\n            pic: pic,\n            thumbnails: pic\n          }\n        })\n      })\n    })\n  }\n\n  render(){\n    const { movie,relativeMovies } = this.state;\n    if(!movie){\n      return null;\n    } \n    return(\n      <div className=\"flex-row full\">\n        <div className=\"page-shade\">\n          <div className=\"video-wrapper\">\n            <div id=\"videoPlayer\" data-src={ site + movie.coverKey } data-video={ site + movie.videoKey } />\n          </div>\n          <div className=\"video-sidebar\">\n            <Link className=\"homeLink\" to={'/'}>\n              回到首页\n            </Link>\n            <Tabs defaultActiveKey=\"1\" onChange={callback}>\n              <TabPane tab=\"关于本片\" key=\"1\">\n                <h1>{movie.title}</h1>\n                <dl>\n                  <dt>豆瓣评分：<Badge count={movie.rate} style={{ backgroundColor: '#52c41a' }} /> 分</dt>\n                  <dt>电影分类：{movie.tags && movie.tags.join(' ')}</dt>\n                  <dt>更新时间：{moment(movie.meta.createdAt).fromNow()}</dt>\n                  <dt>影片介绍：</dt>\n                  <dd>{movie.summary}</dd>\n                </dl>\n              </TabPane>\n              <TabPane tab=\"同类电影\" key=\"2\">\n                {\n                  relativeMovies.map(item => (\n                    <Link key={item._id} className=\"media\" to={`/detail/${item._id}`}>\n                      <img width=\"60\" className=\"align-self-center mr-3\" src={site + item.posterKey} alt={item.rawTitle} />\n                      <div className=\"media-body\">\n                        <h6 className=\"media-title\">{item.title}</h6>\n                        <ul className=\"list-unstyled\">\n                          {\n                            item.pubdate && item.pubdate.map((it, i) => (\n                              <li key={i}>{moment(it.date).format('YYYY.MM')} ({it.country})</li>\n                            ))\n                          }\n                        </ul>\n                      </div>\n                    </Link>\n                  ))\n                }\n              </TabPane>\n            </Tabs>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}"]}